import{d as S,r as a,b as T,c as $,a as o,e as s,f as r,u as z,q as d,k as E,L as F,o as A,E as h,x as y,A as I}from"./index-BAnCtb42.js";import{U as L}from"./UniversalTable-De1ynEdV.js";import"./database-B5yYN_Wa.js";import j from"./user-QzlZX5LK.js";import"./useFireStorage-H2zJQsii.js";import{s as q,e as M}from"./useToast-DKlWDkpx.js";import"./useDate-CVzJcmyJ.js";/* empty css                                                                       */const R={class:"grid"},Y={class:"col-12 px-2"},G={class:"card"},H={class:"my-2"},J={class:"flex align-items-center justify-content-center"},K=o("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1),le=S({__name:"UserList",setup(O){const c=E(),p=new j,m=a(),_=a([{field:"email",header:"帳號",sortable:!1,style:"min-width:10rem;"},{field:"displayName",header:"名稱",sortable:!1,style:"min-width:10rem;"},{field:"role.displayName",header:"權限身分",sortable:!0,style:"min-width:10rem;"},{field:"uid",header:"UID",sortable:!0,style:"min-width:10rem;"},{type:"boolean",field:"emailVerified",header:"信箱驗證",sortable:!0,style:"min-width:8rem;"},{type:"tag",tag:[{value:"enable",severity:"success",text:"啟用"},{value:"xxx",severity:"warning",text:"異常"},{value:"disabled",severity:"danger",text:"停用"}],field:"state",header:"狀態",sortable:!0,style:"min-width:6rem;"},{type:"date",field:"operateAt",header:"上次操作時間",sortable:!0,style:"min-width:10rem;"}]),x=a([{type:"Dropdown",options:[{value:"true",text:"已驗證"},{value:"false",text:"未驗證"}],placeholder:"信箱驗證",class:"md:mr-1 md:w-3",field:"emailVerified"},{type:"Dropdown",options:[{value:"enable",text:"啟用"},{value:"disabled",text:"停用"}],placeholder:"狀態",class:"md:mr-1 md:w-3",field:"state"},{type:"InputText",placeholder:"Search...",class:"md:w-3",field:"displayName"}]),v=a([]),u=a(),f=a([]),n=a(!1);T(()=>{p.array().then(t=>{v.value=t})});const w=()=>{c.push("/system/user/add")},C=t=>{c.push(`/system/user/edit/${t.uid}`)},g=t=>{u.value=t,n.value=!0},k=async()=>{await p.update(u.value.uid,{state:"delete"}).then(t=>{q(t),c.push("/system/user/list")}).catch(t=>{M(t)}),n.value=!1},U=()=>{m.value.exportCSV()};return(t,l)=>{const i=d("Button"),D=d("Toolbar"),N=d("Column"),V=d("Dialog"),b=F("role");return A(),$("div",R,[o("div",Y,[o("div",G,[s(D,{class:"mb-4"},{start:r(()=>[o("div",H,[s(i,{label:"新增",icon:"pi pi-plus",class:"p-button-success mr-2",onClick:w})])]),end:r(()=>[s(i,{label:"Export",icon:"pi pi-upload",class:"p-button-help",onClick:l[0]||(l[0]=e=>U())})]),_:1}),s(z(L),{ref_key:"dt",ref:m,data:v.value,columns:_.value,selection:f.value,"onUpdate:selection":l[1]||(l[1]=e=>f.value=e),header:"帳號管理",checkbox:!0,filter:x.value},{footer:r(()=>[s(N,{headerStyle:"min-width:10rem;",header:"操作",alignFrozen:"right",frozen:""},{body:r(e=>[h(s(i,{icon:"pi pi-pencil",class:"p-button-rounded p-button-success mr-2",onClick:B=>C(e.data)},null,8,["onClick"]),[[b,["user:u"]]]),h(s(i,{icon:"pi pi-trash",class:"p-button-rounded p-button-warning mt-2",onClick:B=>g(e.data)},null,8,["onClick"]),[[b,["user:d"]]])]),_:1})]),_:1},8,["data","columns","selection","filter"]),s(V,{visible:n.value,"onUpdate:visible":l[3]||(l[3]=e=>n.value=e),style:{width:"450px"},header:"Confirm",modal:!0},{footer:r(()=>[s(i,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:l[2]||(l[2]=e=>n.value=!1)}),s(i,{label:"Yes",icon:"pi pi-check",class:"p-button-text",onClick:k})]),default:r(()=>{var e;return[o("div",J,[K,o("span",null,[y("你確定要刪除 "),o("b",null,I((e=u.value)==null?void 0:e.displayName),1),y(" 嗎?")])])]}),_:1},8,["visible"])])])])}}});export{le as default};
