import{d as S,r as i,b as T,o as $,c as z,a as l,e as t,f as r,u as E,q as d,k as F,L as A,E as m,x as y,A as I}from"./index-IOU40qfs.js";import{U as L}from"./UniversalTable-stfXCdpp.js";import"./database-Cw0t9ydm.js";import j from"./user-DVNX4K8t.js";import"./useFireStorage-B9wjvMUc.js";import{s as q,e as M}from"./useToast-BWUqdmsh.js";/* empty css                                                                       */const R={class:"grid"},Y={class:"col-12 px-2"},G={class:"card"},H={class:"my-2"},J={class:"flex align-items-center justify-content-center"},K=l("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1),se=S({__name:"UserList",setup(O){const c=F(),f=new j,v=i(),_=i([{field:"email",header:"帳號",sortable:!1,style:"min-width:10rem;"},{field:"displayName",header:"名稱",sortable:!1,style:"min-width:10rem;"},{field:"role.displayName",header:"權限身分",sortable:!0,style:"min-width:10rem;"},{field:"uid",header:"UID",sortable:!0,style:"min-width:10rem;"},{type:"boolean",field:"emailVerified",header:"信箱驗證",sortable:!0,style:"min-width:8rem;"},{type:"tag",tag:[{value:"enable",severity:"success",text:"啟用"},{value:"xxx",severity:"warning",text:"異常"},{value:"disabled",severity:"danger",text:"停用"}],field:"state",header:"狀態",sortable:!0,style:"min-width:6rem;"},{type:"date",field:"operateAt",header:"上次操作時間",sortable:!0,style:"min-width:10rem;"}]),x=i([{type:"Dropdown",options:[{value:"true",text:"已驗證"},{value:"false",text:"未驗證"}],placeholder:"信箱驗證",class:"md:mr-1 md:w-3",field:"emailVerified"},{type:"Dropdown",options:[{value:"enable",text:"啟用"},{value:"disabled",text:"停用"}],placeholder:"狀態",class:"md:mr-1 md:w-3",field:"state"},{type:"InputText",placeholder:"Search...",class:"md:w-3",field:"displayName"}]),h=i([]),u=i(),n=i(!1);T(()=>{b()});const b=()=>{f.array().then(e=>{h.value=e})},w=()=>{c.push("/system/user/add")},C=e=>{c.push(`/system/user/edit/${e.uid}`)},g=e=>{u.value=e,n.value=!0},k=async()=>{await f.update(u.value.uid,{state:"delete"}).then(e=>{q(e),c.push("/system/user/list")}).catch(e=>{M(e)}),b(),n.value=!1},D=()=>{v.value.exportCSV()};return(e,a)=>{const o=d("Button"),U=d("Toolbar"),N=d("Column"),V=d("Dialog"),p=A("role");return $(),z("div",R,[l("div",Y,[l("div",G,[t(U,{class:"mb-4"},{start:r(()=>[l("div",H,[m(t(o,{label:"新增",icon:"pi pi-plus",class:"p-button-success mr-2",onClick:w},null,512),[[p,["user:c"]]])])]),end:r(()=>[t(o,{label:"Export",icon:"pi pi-upload",class:"p-button-help",onClick:a[0]||(a[0]=s=>D())})]),_:1}),t(E(L),{ref_key:"dt",ref:v,data:h.value,columns:_.value,header:"帳號管理",filter:x.value},{footer:r(()=>[t(N,{headerStyle:"min-width:10rem;",header:"操作",alignFrozen:"right",frozen:""},{body:r(s=>[m(t(o,{icon:"pi pi-pencil",class:"p-button-rounded p-button-success mr-2",onClick:B=>C(s.data)},null,8,["onClick"]),[[p,["user:u"]]]),m(t(o,{icon:"pi pi-trash",class:"p-button-rounded p-button-warning mt-2",onClick:B=>g(s.data)},null,8,["onClick"]),[[p,["user:d"]]])]),_:1})]),_:1},8,["data","columns","filter"]),t(V,{visible:n.value,"onUpdate:visible":a[2]||(a[2]=s=>n.value=s),style:{width:"450px"},header:"Confirm",modal:!0},{footer:r(()=>[t(o,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:a[1]||(a[1]=s=>n.value=!1)}),t(o,{label:"Yes",icon:"pi pi-check",class:"p-button-text",onClick:k})]),default:r(()=>{var s;return[l("div",J,[K,l("span",null,[y("你確定要刪除 "),l("b",null,I((s=u.value)==null?void 0:s.displayName),1),y(" 嗎?")])])]}),_:1},8,["visible"])])])])}}});export{se as default};
