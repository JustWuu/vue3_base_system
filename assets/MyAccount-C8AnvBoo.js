import"./database-BFU37Xrg.js";import P from"./useAuth-C5SUOMAl.js";import{d as x,r as v,q as $,o as c,D as w,_ as I,M as U,H as F,c as V,a as e,e as s,f as B,u as i,F as N,C as y}from"./index-CYLifkRk.js";/* empty css                                                                       */import"./Editor-kc3vYnik.js";import C from"./user-CYFzg2Fn.js";import{_ as M}from"./InputTextFloat.vue_vue_type_script_setup_true_lang-ASmWi3BN.js";import{_ as A}from"./DebounceButton.vue_vue_type_script_setup_true_lang-XxEBXyGU.js";import{s as g,e as h}from"./useToast-Cq1b9B8o.js";import{F as b}from"./FloatText-Bh6wRJVy.js";import{_ as k}from"./InputPasswordFloat.vue_vue_type_script_setup_true_lang-Cpib73VR.js";const q=x({__name:"PageMenu",props:{modelValue:[Number],model:{type:Array,default(){return[]}}},setup(f){const u=v(f.modelValue);return(r,t)=>{const o=$("TabMenu");return c(),w(o,{class:"tab-menu",activeIndex:u.value,"onUpdate:activeIndex":t[0]||(t[0]=a=>u.value=a),onTabChange:t[1]||(t[1]=a=>r.$emit("update:modelValue",a.index)),model:f.model},null,8,["activeIndex","model"])}}}),E=I(q,[["__scopeId","data-v-bd8d10e6"]]),T={class:"col-12 md:col-6 px-2"},j={class:"card p-fluid"},D=e("h5",null,"大頭照",-1),S={class:"field"},H={class:"flex justify-content-center .p-avatar.p-avatar-circle p-avatar-circle"},L={class:"col-12 md:col-6 px-2"},O={class:"card p-fluid"},R=e("h5",null,"帳戶資料",-1),z={class:"field mt-5"},G={class:"field mt-5"},J={class:"field mt-5"},K={class:"field mt-5"},Q={class:"field mt-5"},W=x({__name:"AccountInfo",setup(f){const l=new P,u=new C,{user:r}=l.getUser(),t=v({...U}),o=()=>{l.update({displayName:t.value.displayName}).then(a=>{g(`${a}`)}).catch(a=>{h(a)})};return F(()=>{r.value.uid&&u.get(r.value.uid).then(a=>{t.value=a})}),(a,p)=>{var m;const n=$("Image"),d=$("VForm");return c(),V(N,null,[e("div",T,[e("div",j,[D,e("div",S,[e("div",H,[s(n,{src:(m=t.value)==null?void 0:m.photoURL,alt:"",width:"200",height:"200"},null,8,["src"])])])])]),e("div",L,[e("div",O,[s(d,{ref:"signinForm",onSubmit:p[1]||(p[1]=_=>o())},{default:B(()=>[R,e("div",z,[s(i(M),{label:"名稱",modelValue:t.value.displayName,"onUpdate:modelValue":p[0]||(p[0]=_=>t.value.displayName=_),name:"displayName",rules:"required"},null,8,["modelValue"])]),e("div",G,[s(i(b),{label:"信箱",content:t.value.email},null,8,["content"])]),e("div",J,[s(i(b),{label:"UID",content:t.value.uid},null,8,["content"])]),e("div",K,[s(i(b),{label:"權限",content:t.value.role.displayName},null,8,["content"])]),e("div",Q,[s(i(b),{label:"狀態",content:t.value.stateValue},null,8,["content"])]),s(i(A),{label:"送出",type:"submit"})]),_:1},512)])])],64)}}}),X={class:"col-12 md:col-6 px-2"},Y={class:"card p-fluid"},Z=e("h5",null,"信箱認證狀態",-1),ee={class:"field mt-5"},te={key:0},se={key:1},le={class:"col-12 md:col-6 px-2"},oe={class:"card p-fluid"},ae=e("h5",null,"變更密碼",-1),ne={class:"field mt-5"},de={class:"field mt-5"},ie=x({__name:"AccountSecurity",setup(f){const l=new P,u=new C,{user:r}=l.getUser(),t=v({...U}),o=v({oldPassword:"",newPassword:""}),a=()=>{l.sendEmail().then(n=>{n&&g("驗證信已送出")}).catch(n=>{h(n)})},p=(n,d)=>{if(n==="")return h("請輸入舊密碼");if(d==="")return h("請輸入新密碼");l.updatePassword(n,d).then(()=>{g("密碼變更成功")}).catch(m=>{h(m)})};return F(()=>{r.value.uid&&u.get(r.value.uid).then(n=>{t.value=n})}),(n,d)=>{const m=$("Button");return c(),V(N,null,[e("div",X,[e("div",Y,[Z,e("div",ee,[s(i(b),{label:"信箱",content:t.value.email},null,8,["content"]),t.value.emailVerified?(c(),V("small",te,"信箱已認證")):(c(),V("small",se,"尚未認證信箱，請點擊按鈕發送驗證信件"))]),t.value.emailVerified?y("",!0):(c(),w(m,{key:0,label:"送出驗證信",onClick:a}))])]),e("div",le,[e("div",oe,[ae,e("div",ne,[s(i(k),{label:"舊密碼",modelValue:o.value.oldPassword,"onUpdate:modelValue":d[0]||(d[0]=_=>o.value.oldPassword=_),name:"password",rules:"required",feedback:!1},null,8,["modelValue"])]),e("div",de,[s(i(k),{label:"新密碼",modelValue:o.value.newPassword,"onUpdate:modelValue":d[1]||(d[1]=_=>o.value.newPassword=_),name:"newPassword",rules:"required"},null,8,["modelValue"])]),s(m,{label:"變更",onClick:d[2]||(d[2]=_=>p(o.value.oldPassword,o.value.newPassword))})])])],64)}}}),ce={class:"grid"},ue={class:"col-12 px-2"},xe=x({__name:"MyAccount",setup(f){const l=v(0),u=v([{label:"個人資訊",icon:"pi pi-id-card"},{label:"安全性",icon:"pi pi-lock"}]);return(r,t)=>(c(),V("div",ce,[e("div",ue,[s(i(E),{modelValue:l.value,"onUpdate:modelValue":t[0]||(t[0]=o=>l.value=o),model:u.value},null,8,["modelValue","model"])]),l.value===0?(c(),w(W,{key:0})):y("",!0),l.value===1?(c(),w(ie,{key:1})):y("",!0)]))}});export{xe as default};
