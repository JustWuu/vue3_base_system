import"./database-Cw0t9ydm.js";import{A as P}from"./useFireStorage-B9wjvMUc.js";import{d as x,r as p,q as $,o as i,D as V,_ as N,M as F,H as U,c as b,a as e,e as a,f as A,u as c,F as C,C as y}from"./index-IOU40qfs.js";/* empty css                                                                       */import"./Editor-kc3vYnik.js";import I from"./user-DVNX4K8t.js";import{s as g,e as h}from"./useToast-BWUqdmsh.js";import{F as _}from"./FloatText-efi5VUUk.js";import{_ as k}from"./InputPasswordFloat.vue_vue_type_script_setup_true_lang-BkZak3mZ.js";const B=x({__name:"PageMenu",props:{modelValue:[Number],model:{type:Array,default(){return[]}}},setup(v){const u=p(v.modelValue);return(r,t)=>{const o=$("TabMenu");return i(),V(o,{class:"tab-menu",activeIndex:u.value,"onUpdate:activeIndex":t[0]||(t[0]=l=>u.value=l),onTabChange:t[1]||(t[1]=l=>r.$emit("update:modelValue",l.index)),model:v.model},null,8,["activeIndex","model"])}}}),M=N(B,[["__scopeId","data-v-bd8d10e6"]]),E={class:"col-12 md:col-6 px-2"},T={class:"card p-fluid"},q=e("h5",null,"大頭照",-1),j={class:"field"},D={class:"flex justify-content-center .p-avatar.p-avatar-circle p-avatar-circle"},S={class:"col-12 md:col-6 px-2"},H={class:"card p-fluid"},L=e("h5",null,"帳戶資料",-1),O={class:"field mt-5"},R={class:"field mt-5"},z={class:"field mt-5"},G={class:"field mt-5"},J={class:"field mt-5"},K=x({__name:"AccountInfo",setup(v){const s=new P,u=new I,{user:r}=s.getUser(),t=p({...F}),o=()=>{s.update({displayName:t.value.displayName}).then(l=>{g(`${l}`)}).catch(l=>{h(l)})};return U(()=>{r.value.uid&&u.get(r.value.uid).then(l=>{t.value=l})}),(l,w)=>{var m;const n=$("Image"),d=$("VForm");return i(),b(C,null,[e("div",E,[e("div",T,[q,e("div",j,[e("div",D,[a(n,{src:(m=t.value)==null?void 0:m.photoURL,alt:"",width:"200",height:"200"},null,8,["src"])])])])]),e("div",S,[e("div",H,[a(d,{ref:"signinForm",onSubmit:w[0]||(w[0]=f=>o())},{default:A(()=>[L,e("div",O,[a(c(_),{label:"名稱",content:t.value.displayName},null,8,["content"])]),e("div",R,[a(c(_),{label:"信箱",content:t.value.email},null,8,["content"])]),e("div",z,[a(c(_),{label:"UID",content:t.value.uid},null,8,["content"])]),e("div",G,[a(c(_),{label:"權限",content:t.value.role.displayName},null,8,["content"])]),e("div",J,[a(c(_),{label:"狀態",content:t.value.stateValue},null,8,["content"])])]),_:1},512)])])],64)}}}),Q={class:"col-12 md:col-6 px-2"},W={class:"card p-fluid"},X=e("h5",null,"信箱認證狀態",-1),Y={class:"field mt-5"},Z={key:0},ee={key:1},te={class:"col-12 md:col-6 px-2"},se={class:"card p-fluid"},oe=e("h5",null,"變更密碼",-1),le={class:"field mt-5"},ae={class:"field mt-5"},ne=x({__name:"AccountSecurity",setup(v){const s=new P,u=new I,{user:r}=s.getUser(),t=p({...F}),o=p({oldPassword:"",newPassword:""}),l=()=>{s.sendEmail().then(n=>{n&&g("驗證信已送出")}).catch(n=>{h(n)})},w=(n,d)=>{if(n==="")return h("請輸入舊密碼");if(d==="")return h("請輸入新密碼");s.updatePassword(n,d).then(()=>{g("密碼變更成功")}).catch(m=>{h(m)})};return U(()=>{r.value.uid&&u.get(r.value.uid).then(n=>{t.value=n})}),(n,d)=>{const m=$("Button");return i(),b(C,null,[e("div",Q,[e("div",W,[X,e("div",Y,[a(c(_),{label:"信箱",content:t.value.email},null,8,["content"]),t.value.emailVerified?(i(),b("small",Z,"信箱已認證")):(i(),b("small",ee,"尚未認證信箱，請點擊按鈕發送驗證信件"))]),t.value.emailVerified?y("",!0):(i(),V(m,{key:0,label:"送出驗證信",onClick:l}))])]),e("div",te,[e("div",se,[oe,e("div",le,[a(c(k),{label:"舊密碼",modelValue:o.value.oldPassword,"onUpdate:modelValue":d[0]||(d[0]=f=>o.value.oldPassword=f),name:"password",rules:"required",feedback:!1},null,8,["modelValue"])]),e("div",ae,[a(c(k),{label:"新密碼",modelValue:o.value.newPassword,"onUpdate:modelValue":d[1]||(d[1]=f=>o.value.newPassword=f),name:"newPassword",rules:"required"},null,8,["modelValue"])]),a(m,{label:"變更",onClick:d[2]||(d[2]=f=>w(o.value.oldPassword,o.value.newPassword))})])])],64)}}}),de={class:"grid"},ce={class:"col-12 px-2"},be=x({__name:"MyAccount",setup(v){const s=p(0),u=p([{label:"個人資訊",icon:"pi pi-id-card"},{label:"安全性",icon:"pi pi-lock"}]);return(r,t)=>(i(),b("div",de,[e("div",ce,[a(c(M),{modelValue:s.value,"onUpdate:modelValue":t[0]||(t[0]=o=>s.value=o),model:u.value},null,8,["modelValue","model"])]),s.value===0?(i(),V(K,{key:0})):y("",!0),s.value===1?(i(),V(ne,{key:1})):y("",!0)]))}});export{be as default};
