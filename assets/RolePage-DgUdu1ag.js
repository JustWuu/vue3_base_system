import"./database-B5mFUmtQ.js";import $ from"./role-MHEn8tqF.js";import{S as R,_ as B}from"./DebounceButton.vue_vue_type_script_setup_true_lang-dMutmPpq.js";import"./useFireStorage-Bkb40Xyt.js";import{d as x,r as b,b as C,q as h,o as s,c as g,D as V,f as N,a as o,e as d,m as D,A as I,F as K,y as M,k as P,C as w,u as f,t as q,v as A,_ as E}from"./index-C0IYFN2w.js";import{_ as U}from"./InputTextFloat.vue_vue_type_script_setup_true_lang-D630O6UL.js";import{s as _,e as F}from"./useToast-CIqEXRhq.js";/* empty css                                                                       */import{F as O}from"./FloatText-vgkHFlwl.js";import"./Editor-kc3vYnik.js";const W={class:"p-float-label"},j=["for"],L=x({__name:"InputDropdownFloat",props:{modelValue:[String,Number],type:{type:String,default:"text"},label:{type:String,default:"-"},name:{type:String,default:"-"},placeholder:{type:String},rules:{type:String},options:{type:Array},disabled:{type:Boolean}},setup(e){const p=b(0);return C(()=>{setTimeout(()=>{p.value==0&&p.value++},500)}),(v,r)=>{const c=h("Dropdown"),u=h("VField"),t=h("ErrorMessage");return s(),g(K,null,[(s(),V(u,{key:p.value,name:e.name,label:e.label,type:e.type,class:"p-inputtext p-component",rules:e.rules,value:e.modelValue,onChange:r[0]||(r[0]=m=>v.$emit("update:modelValue",m.value))},{default:N(({field:m})=>[o("span",W,[d(c,D({class:["w-full",{"p-filled":e.modelValue}]},m,{modelValue:e.modelValue,value:e.modelValue,placeholder:e.placeholder,id:e.name,options:e.options,optionLabel:"text",optionValue:"value",disabled:e.disabled}),null,16,["class","modelValue","value","placeholder","id","options","disabled"]),o("label",{for:e.name},I(e.label),9,j)])]),_:1},8,["name","label","type","rules","value"])),d(t,{name:e.name,class:"p-error"},null,8,["name"])],64)}}}),z=e=>(q("data-v-74f6cc91"),e=e(),A(),e),G={class:"grid"},H={class:"col-12 px-2"},J={class:"card p-fluid"},Q={key:0},X={key:1},Y={class:"grid p-fluid mt-3"},Z={class:"col-12 md:col-6"},ee={class:"col-12 md:col-6"},le={class:"col-12"},ae=z(()=>o("h5",null,"權限設定",-1)),te=x({__name:"RolePage",props:{mode:{type:String,default:""}},setup(e){const p=M(),v=P(),r=e,c=new $,u=b(""),t=b({displayName:"",roles:[],id:"",state:"enable"}),m=b([{key:"front",label:"前台",data:"front",icon:"pi pi-fw pi-inbox",children:[{key:"member",label:"會員管理",data:"member",icon:"pi pi-fw pi-users",children:[{key:"member:c",label:"新增",icon:"pi pi-fw pi-file",data:"member:c"},{key:"member:r",label:"查看",icon:"pi pi-fw pi-eye",data:"member:r"},{key:"member:u",label:"更新",icon:"pi pi-fw pi-pencil",data:"member:u"},{key:"member:d",label:"刪除",icon:"pi pi-fw pi-trash",data:"member:d"}]}]},{key:"system",label:"系統",data:"system",icon:"pi pi-fw pi-inbox",children:[{key:"user",label:"帳號管理",data:"user",icon:"pi pi-fw pi-user",children:[{key:"user:c",label:"新增",icon:"pi pi-fw pi-file",data:"user:c"},{key:"user:r",label:"查看",icon:"pi pi-fw pi-eye",data:"user:r"},{key:"user:u",label:"更新",icon:"pi pi-fw pi-pencil",data:"user:u"},{key:"user:d",label:"刪除",icon:"pi pi-fw pi-trash",data:"user:d"}]},{key:"role",label:"權限管理",data:"role",icon:"pi pi-fw pi-sitemap",children:[{key:"role:c",label:"新增",icon:"pi pi-fw pi-file",data:"role:c"},{key:"role:r",label:"查看",icon:"pi pi-fw pi-eye",data:"role:r"},{key:"role:u",label:"更新",icon:"pi pi-fw pi-pencil",data:"role:u"},{key:"role:d",label:"刪除",icon:"pi pi-fw pi-trash",data:"role:d"}]},{key:"syslog",label:"操作紀錄",data:"syslog",icon:"pi pi-fw pi-wrench",children:[{key:"syslog:c",label:"新增",icon:"pi pi-fw pi-file",data:"syslog:c"},{key:"syslog:r",label:"查看",icon:"pi pi-fw pi-eye",data:"syslog:r"},{key:"syslog:u",label:"更新",icon:"pi pi-fw pi-pencil",data:"syslog:u"},{key:"syslog:d",label:"刪除",icon:"pi pi-fw pi-trash",data:"syslog:d"}]},{key:"storage",label:"貯存管理",data:"storage",icon:"pi pi-fw pi-file-arrow-up",children:[{key:"storage:c",label:"新增",icon:"pi pi-fw pi-file",data:"storage:c"},{key:"storage:r",label:"查看",icon:"pi pi-fw pi-eye",data:"storage:r"},{key:"storage:u",label:"更新",icon:"pi pi-fw pi-pencil",data:"storage:u"},{key:"storage:d",label:"刪除",icon:"pi pi-fw pi-trash",data:"storage:d"}]}]}]),i=b({}),T=async a=>{r.mode==="add"?(t.value.roles=S(),c.add(a).then(l=>{_(l),v.push("/system/role/list")}).catch(l=>{F(l)})):r.mode==="edit"&&(t.value.roles=S(),c.update(u.value,a).then(l=>{_(l),v.push("/system/role/list")}).catch(l=>{F(l)}))},S=()=>{const a=[];for(var l in i.value)Object.prototype.hasOwnProperty.call(i.value,l)&&i.value[l].checked===!0&&a.push(l);return a};return C(()=>{r.mode==="edit"&&(u.value=p.params.id,c.get(u.value).then(a=>{t.value=a;for(var l=0;l<a.roles.length;l++)if(a.roles[l].includes(":")){var k=a.roles[l].split(":")[0];i.value[k]||(i.value[k]={checked:!1,partialChecked:!0})}for(var y=0;y<a.roles.length;y++)i.value[a.roles[y]]={checked:!0,partialChecked:!1}}))}),(a,l)=>{const k=h("Tree"),y=h("VForm");return s(),g("div",G,[o("div",H,[d(y,{ref:"signupForm",onSubmit:l[3]||(l[3]=n=>T(t.value))},{default:N(()=>[o("div",J,[e.mode==="add"?(s(),g("h5",Q,"新增權限身分")):e.mode==="edit"?(s(),g("h5",X,"編輯權限身分")):w("",!0),o("div",Y,[o("div",Z,[e.mode==="add"?(s(),V(f(U),{key:0,label:"名稱",modelValue:t.value.displayName,"onUpdate:modelValue":l[0]||(l[0]=n=>t.value.displayName=n),name:"displayName",rules:"required"},null,8,["modelValue"])):w("",!0),e.mode==="edit"?(s(),V(f(O),{key:1,label:"名稱",content:t.value.displayName},null,8,["content"])):w("",!0)]),o("div",ee,[d(f(L),{label:"狀態",options:f(R),modelValue:t.value.state,"onUpdate:modelValue":l[1]||(l[1]=n=>t.value.state=n),name:"state",rules:"required"},null,8,["options","modelValue"])]),o("div",le,[ae,d(k,{value:m.value,selectionMode:"checkbox",selectionKeys:i.value,"onUpdate:selectionKeys":l[2]||(l[2]=n=>i.value=n),expandedKeys:{system:!0,user:!0,role:!0,syslog:!0}},null,8,["value","selectionKeys"])])]),d(f(B),{label:"送出",type:"submit"})])]),_:1},512)])])}}}),ye=E(te,[["__scopeId","data-v-74f6cc91"]]);export{ye as R};
