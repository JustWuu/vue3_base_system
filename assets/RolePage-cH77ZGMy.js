import"./database-BFU37Xrg.js";import{S as $}from"./Universal-Q_iCI1DR.js";import R from"./role-h_K0QeZ_.js";import"./useAuth-C5SUOMAl.js";import{d as x,r as b,b as C,q as h,o as s,c as v,D as V,f as N,a as i,e as d,m as B,A as D,F as I,y as K,k as M,C as g,u as f,t as P,v as q,_ as A}from"./index-CYLifkRk.js";import{_ as E}from"./InputTextFloat.vue_vue_type_script_setup_true_lang-ASmWi3BN.js";import{_ as U}from"./DebounceButton.vue_vue_type_script_setup_true_lang-XxEBXyGU.js";import{s as _,e as F}from"./useToast-Cq1b9B8o.js";/* empty css                                                                       */import{F as O}from"./FloatText-Bh6wRJVy.js";import"./Editor-kc3vYnik.js";const W={class:"p-float-label"},j=["for"],L=x({__name:"InputDropdownFloat",props:{modelValue:[String,Number],type:{type:String,default:"text"},label:{type:String,default:"-"},name:{type:String,default:"-"},placeholder:{type:String},rules:{type:String},options:{type:Array},disabled:{type:Boolean}},setup(e){const p=b(0);return C(()=>{setTimeout(()=>{p.value==0&&p.value++},500)}),(w,n)=>{const c=h("Dropdown"),u=h("VField"),o=h("ErrorMessage");return s(),v(I,null,[(s(),V(u,{key:p.value,name:e.name,label:e.label,type:e.type,class:"p-inputtext p-component",rules:e.rules,value:e.modelValue,onChange:n[0]||(n[0]=m=>w.$emit("update:modelValue",m.value))},{default:N(({field:m})=>[i("span",W,[d(c,B({class:["w-full",{"p-filled":e.modelValue}]},m,{modelValue:e.modelValue,value:e.modelValue,placeholder:e.placeholder,id:e.name,options:e.options,optionLabel:"text",optionValue:"value",disabled:e.disabled}),null,16,["class","modelValue","value","placeholder","id","options","disabled"]),i("label",{for:e.name},D(e.label),9,j)])]),_:1},8,["name","label","type","rules","value"])),d(o,{name:e.name,class:"p-error"},null,8,["name"])],64)}}}),z=e=>(P("data-v-ca524f01"),e=e(),q(),e),G={class:"grid"},H={class:"col-12 px-2"},J={class:"card p-fluid"},Q={key:0},X={key:1},Y={class:"grid p-fluid mt-3"},Z={class:"col-12 md:col-6"},ee={class:"col-12 md:col-6"},le={class:"col-12"},ae=z(()=>i("h5",null,"權限設定",-1)),oe=x({__name:"RolePage",props:{mode:{type:String,default:""}},setup(e){const p=K(),w=M(),n=e,c=new R,u=b(""),o=b({displayName:"",roles:[],id:"",state:"enable"}),m=b([{key:"front",label:"前台",data:"front",icon:"pi pi-fw pi-inbox",children:[{key:"news",label:"公告管理",data:"news",icon:"pi pi-fw pi-users",children:[{key:"news:c",label:"新增",icon:"pi pi-fw pi-file",data:"news:c"},{key:"news:r",label:"查看",icon:"pi pi-fw pi-eye",data:"news:r"},{key:"news:u",label:"更新",icon:"pi pi-fw pi-pencil",data:"news:u"},{key:"news:d",label:"刪除",icon:"pi pi-fw pi-trash",data:"news:d"}]},{key:"recommend",label:"每周推薦",data:"recommend",icon:"pi pi-fw pi-users",children:[{key:"recommend:c",label:"新增",icon:"pi pi-fw pi-file",data:"recommend:c"},{key:"recommend:r",label:"查看",icon:"pi pi-fw pi-eye",data:"recommend:r"},{key:"recommend:u",label:"更新",icon:"pi pi-fw pi-pencil",data:"recommend:u"},{key:"recommend:d",label:"刪除",icon:"pi pi-fw pi-trash",data:"recommend:d"}]},{key:"member",label:"會員管理",data:"member",icon:"pi pi-fw pi-users",children:[{key:"member:c",label:"新增",icon:"pi pi-fw pi-file",data:"member:c"},{key:"member:r",label:"查看",icon:"pi pi-fw pi-eye",data:"member:r"},{key:"member:u",label:"更新",icon:"pi pi-fw pi-pencil",data:"member:u"},{key:"member:d",label:"刪除",icon:"pi pi-fw pi-trash",data:"member:d"}]}]},{key:"system",label:"系統",data:"system",icon:"pi pi-fw pi-inbox",children:[{key:"user",label:"帳號管理",data:"user",icon:"pi pi-fw pi-user",children:[{key:"user:c",label:"新增",icon:"pi pi-fw pi-file",data:"user:c"},{key:"user:r",label:"查看",icon:"pi pi-fw pi-eye",data:"user:r"},{key:"user:u",label:"更新",icon:"pi pi-fw pi-pencil",data:"user:u"},{key:"user:d",label:"刪除",icon:"pi pi-fw pi-trash",data:"user:d"}]},{key:"role",label:"權限管理",data:"role",icon:"pi pi-fw pi-sitemap",children:[{key:"role:c",label:"新增",icon:"pi pi-fw pi-file",data:"role:c"},{key:"role:r",label:"查看",icon:"pi pi-fw pi-eye",data:"role:r"},{key:"role:u",label:"更新",icon:"pi pi-fw pi-pencil",data:"role:u"},{key:"role:d",label:"刪除",icon:"pi pi-fw pi-trash",data:"role:d"}]},{key:"syslog",label:"操作紀錄",data:"syslog",icon:"pi pi-fw pi-wrench",children:[{key:"syslog:c",label:"新增",icon:"pi pi-fw pi-file",data:"syslog:c"},{key:"syslog:r",label:"查看",icon:"pi pi-fw pi-eye",data:"syslog:r"},{key:"syslog:u",label:"更新",icon:"pi pi-fw pi-pencil",data:"syslog:u"},{key:"syslog:d",label:"刪除",icon:"pi pi-fw pi-trash",data:"syslog:d"}]}]}]),t=b({}),T=async a=>{n.mode==="add"?(o.value.roles=S(),c.add(a).then(l=>{_(l),w.push("/system/role/list")}).catch(l=>{F(l)})):n.mode==="edit"&&(o.value.roles=S(),c.update(u.value,a).then(l=>{_(l),w.push("/system/role/list")}).catch(l=>{F(l)}))},S=()=>{const a=[];for(var l in t.value)Object.prototype.hasOwnProperty.call(t.value,l)&&t.value[l].checked===!0&&a.push(l);return a};return C(()=>{n.mode==="edit"&&(u.value=p.params.id,c.get(u.value).then(a=>{o.value=a;for(var l=0;l<a.roles.length;l++)if(a.roles[l].includes(":")){var k=a.roles[l].split(":")[0];t.value[k]||(t.value[k]={checked:!1,partialChecked:!0})}for(var y=0;y<a.roles.length;y++)t.value[a.roles[y]]={checked:!0,partialChecked:!1}}))}),(a,l)=>{const k=h("Tree"),y=h("VForm");return s(),v("div",G,[i("div",H,[d(y,{ref:"signupForm",onSubmit:l[3]||(l[3]=r=>T(o.value))},{default:N(()=>[i("div",J,[e.mode==="add"?(s(),v("h5",Q,"新增權限身分")):e.mode==="edit"?(s(),v("h5",X,"編輯權限身分")):g("",!0),i("div",Y,[i("div",Z,[e.mode==="add"?(s(),V(f(E),{key:0,label:"名稱",modelValue:o.value.displayName,"onUpdate:modelValue":l[0]||(l[0]=r=>o.value.displayName=r),name:"displayName",rules:"required"},null,8,["modelValue"])):g("",!0),e.mode==="edit"?(s(),V(f(O),{key:1,label:"名稱",content:o.value.displayName},null,8,["content"])):g("",!0)]),i("div",ee,[d(f(L),{label:"狀態",options:f($),modelValue:o.value.state,"onUpdate:modelValue":l[1]||(l[1]=r=>o.value.state=r),name:"state",rules:"required"},null,8,["options","modelValue"])]),i("div",le,[ae,d(k,{value:m.value,selectionMode:"checkbox",selectionKeys:t.value,"onUpdate:selectionKeys":l[2]||(l[2]=r=>t.value=r),expandedKeys:{system:!0,user:!0,role:!0,syslog:!0}},null,8,["value","selectionKeys"])])]),d(f(U),{label:"送出",type:"submit"})])]),_:1},512)])])}}}),fe=A(oe,[["__scopeId","data-v-ca524f01"]]);export{fe as R};
